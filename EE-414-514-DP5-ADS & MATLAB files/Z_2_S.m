%--------------------------------------------------------------------

function S = Z_2_S(Zoc, Z0)

%--------------------------------------------------------------------

U = eye(size(Zoc));

ZC = zeros(size(Zoc));

%--------------------------------------------------------------------

if length(Zoc) == length(Z0)
    for ii = 1:length(Zoc)
        ZC(ii, ii) = Z0(ii);
    end
else
    ZC = Z0 * U;
end

%--------------------------------------------------------------------

RCs = sqrt(ZC);

RCsi = (RCs)^(-1);

%--------------------------------------------------------------------

z = RCsi * Zoc * RCsi;

S = (z + U)^(-1) * (z - U );

%--------------------------------------------------------------------
